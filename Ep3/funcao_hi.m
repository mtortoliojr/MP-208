%%--------------------------------------------------------------------------------
%% Função para o cálculo de hi(x,pGi)
%%--------------------------------------------------------------------------------
function hi = funcao_hi(x,pGi)

% Parâmetros
f = 1;
DCP = diag([1,-1,-1]);
rPCP = [0 0 0]';

% Componentes de x
rGPG = x(1:3);
alfa = x(7:9);

% Cálculo da matrix DPG e Alfa
DPG = matriz_DPG(alfa);

% --------------------------------------------------------------
% Vetor sCi
% --------------------------------------------------------------
sCi = DCP * DPG * (pGi - rGPG) - DCP * rPCP;

% --------------------------------------------------------------
% Vetor hi
% --------------------------------------------------------------
hi = f * [sCi(1);sCi(2)] / sCi(3);

end
